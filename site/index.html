<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bus Check: Is CTA's Frequent Network Working?</title>
<meta name="description" content="Data analysis of CTA's Frequent Network: ridership impact and headway adherence for 20 Chicago bus routes.">

<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>

<!-- ═══ NAV ═══ -->
<nav class="site-nav">
  <div class="container">
    <a href="index.html" class="nav-active">Analysis</a>
    <a href="headways.html">Headways</a>
    <a href="methodology.html">Methodology</a>
    <a href="reproducibility.html">Reproducibility</a>
  </div>
</nav>

<!-- ═══ HERO ═══ -->
<header class="hero">
  <div class="container">
    <div class="hero-eyebrow">CTA Frequent Network Analysis</div>
    <h1>Is Chicago's Bus Frequency Promise Working?</h1>
    <p class="hero-subtitle">In 2025, CTA rolled out its Frequent Network&mdash;20 bus routes promised 10-minute headways. We analyzed ridership data and real-time vehicle positions to find out if it's delivering.</p>
  </div>
</header>

<!-- ═══ KEY FINDING CALLOUT ═══ -->
<div class="callout">
  <div class="container">
    <div class="callout-label">Key Finding</div>
    <h2>Ridership is up +4.2% to +10.4% on every phase with data</h2>
    <p>Using phase-level difference-in-differences with bootstrap confidence intervals, we compared Frequent Network routes against similar non-FN routes. When each rollout phase is analyzed separately, all three with sufficient post-launch data show statistically significant ridership gains. These results are corroborated by a Callaway-Sant&rsquo;Anna staggered estimator and regression with fixed effects.</p>
  </div>
</div>

<!-- ═══ ROUTE MAP ═══ -->
<section>
  <div class="container">
    <h2>The 20 Routes</h2>
    <p class="section-lead">CTA's Frequent Network rolled out in four phases from March to December 2025. Click any route for details.</p>
    <div class="phase-legend">
      <span class="phase-pill"><span class="phase-dot" style="background:var(--phase-1)"></span>Phase 1 &middot; Mar 2025</span>
      <span class="phase-pill"><span class="phase-dot" style="background:var(--phase-2)"></span>Phase 2 &middot; Jun 2025</span>
      <span class="phase-pill"><span class="phase-dot" style="background:var(--phase-3)"></span>Phase 3 &middot; Aug 2025</span>
      <span class="phase-pill"><span class="phase-dot" style="background:var(--phase-4)"></span>Phase 4 &middot; Dec 2025</span>
    </div>
    <div id="map"></div>
  </div>
</section>

<!-- ═══ DID BY PHASE ═══ -->
<section>
  <div class="container">
    <h2>Ridership Impact by Phase</h2>
    <p class="section-lead">Phase-level difference-in-differences estimates with cluster-bootstrap confidence intervals, comparing Frequent Network routes to similar non-FN routes. Each phase is analyzed separately with its own control group. <a href="methodology.html" style="color:var(--accent)">Why this approach?</a></p>

    <table class="did-table">
      <thead>
        <tr><th>Phase</th><th>Routes</th><th>Effect (rides/day)</th><th>Effect (%)</th><th>95% CI</th></tr>
      </thead>
      <tbody>
        <tr>
          <td><span class="did-phase-dot" style="background:var(--phase-1)"></span>Phase 1</td>
          <td>J14, 34, 47, 54, 60, 63, 79, 95</td>
          <td class="did-estimate" style="color:var(--positive)">+428</td>
          <td class="did-estimate" style="color:var(--positive)">+5.9%</td>
          <td class="did-ci">[+42, +799]</td>
        </tr>
        <tr>
          <td><span class="did-phase-dot" style="background:var(--phase-2)"></span>Phase 2</td>
          <td>4, 20, 49, 66</td>
          <td class="did-estimate" style="color:var(--positive)">+514</td>
          <td class="did-estimate" style="color:var(--positive)">+4.2%</td>
          <td class="did-ci">[+163, +832]</td>
        </tr>
        <tr>
          <td><span class="did-phase-dot" style="background:var(--phase-3)"></span>Phase 3</td>
          <td>53, 55, 77, 82</td>
          <td class="did-estimate" style="color:var(--positive)">+1,142</td>
          <td class="did-estimate" style="color:var(--positive)">+10.4%</td>
          <td class="did-ci">[+213, +2,492]</td>
        </tr>
        <tr>
          <td><span class="did-phase-dot" style="background:var(--phase-4)"></span>Phase 4</td>
          <td>9, 12, 72, 81</td>
          <td class="did-estimate" style="color:var(--ink-faint)">&mdash;</td>
          <td class="did-estimate" style="color:var(--ink-faint)">&mdash;</td>
          <td class="did-ci">No post-launch data</td>
        </tr>
      </tbody>
    </table>

    <div class="chart-wrap"><div id="chart-did"></div></div>
  </div>
</section>

<!-- ═══ YOY BY ROUTE ═══ -->
<section>
  <div class="container">
    <h2>Year-Over-Year Ridership Change</h2>
    <p class="section-lead">Comparing matched calendar periods before and after each phase launched. 13 of 16 Phase 1&ndash;3 routes gained riders. J14 Jeffery Jump leads at +26.1%.</p>
    <div class="phase-legend">
      <span class="phase-pill"><span class="phase-dot" style="background:var(--phase-1)"></span>Phase 1</span>
      <span class="phase-pill"><span class="phase-dot" style="background:var(--phase-2)"></span>Phase 2</span>
      <span class="phase-pill"><span class="phase-dot" style="background:var(--phase-3)"></span>Phase 3</span>
    </div>
    <div class="chart-wrap"><div id="chart-yoy"></div></div>
  </div>
</section>

<!-- ═══ RIDERSHIP SHARE ═══ -->
<section>
  <div class="container">
    <h2>Growing Share of Total Ridership</h2>
    <p class="section-lead">Frequent Network routes are capturing a growing share of CTA's total bus ridership after each phase launch. Importantly, total CTA bus ridership also grew during this period&mdash;the rising FN share reflects genuine ridership growth on frequent routes, not just riders switching from other buses.</p>
    <div class="chart-wrap"><div id="chart-share"></div></div>
  </div>
</section>

<!-- ═══ HEADWAY TEASER ═══ -->
<section>
  <div class="container">
    <h2>Are Buses Actually Running Every 10 Minutes?</h2>
    <p class="section-lead">We also tracked real-time bus positions using CTA's Bus Tracker API to measure whether routes actually achieve the promised 10-minute headways. Early results suggest a gap between schedule and reality.</p>
    <a href="headways.html" class="page-link">See the headway analysis &rarr;</a>
  </div>
</section>

<!-- ═══ METHODOLOGY TEASER ═══ -->
<section>
  <div class="container">
    <h2>Methodology</h2>
    <p class="section-lead">This analysis uses difference-in-differences to estimate the causal impact of the Frequent Network on ridership, with phase-level estimation to avoid bias from staggered treatment timing. We ran eight separate analyses to stress-test the findings from different angles&mdash;pooled, phase-level, staggered (Callaway-Sant'Anna), and regression with fixed effects.</p>
    <a href="methodology.html" class="page-link">Read the full methodology &rarr;</a>
  </div>
</section>

<!-- ═══ FOOTER ═══ -->
<footer>
  <div class="container">
    <div class="footer-grid">
      <div>
        <dl class="footer-sources">
          <dt>Ridership data</dt>
          <dd>Chicago Data Portal SODA API &middot; Through Nov 30, 2025</dd>
          <dt>Real-time positions</dt>
          <dd>CTA Bus Tracker API &middot; <a href="headways.html">See headway analysis</a></dd>
          <dt>Schedules</dt>
          <dd>CTA GTFS static feed</dd>
        </dl>
      </div>
      <div style="text-align:right;">
        <p style="margin-bottom:8px"><a href="https://github.com/sbahamon/bus-check">Source code &amp; notebooks</a></p>
        <p style="margin-bottom:8px"><a href="methodology.html">Methodology</a></p>
        <p>Last updated February 2026</p>
      </div>
    </div>
  </div>
</footer>

<script>
// ── DATA ──
const PHASE_COLORS = {1:'#0066CC', 2:'#2A9D4E', 3:'#E67E22', 4:'#C0392B'};

const YOY_DATA = [
  {route:'J14', name:'Jeffery Jump', phase:1, yoy:26.1},
  {route:'60', name:'Blue Island/26th', phase:1, yoy:13.6},
  {route:'95', name:'95th', phase:1, yoy:12.8},
  {route:'63', name:'63rd', phase:1, yoy:7.5},
  {route:'54', name:'Cicero', phase:1, yoy:1.7},
  {route:'34', name:'South Michigan', phase:1, yoy:1.2},
  {route:'47', name:'47th', phase:1, yoy:0.5},
  {route:'79', name:'79th', phase:1, yoy:-6.2},
  {route:'20', name:'Madison', phase:2, yoy:7.4},
  {route:'49', name:'Western', phase:2, yoy:6.8},
  {route:'66', name:'Chicago', phase:2, yoy:5.4},
  {route:'4', name:'Cottage Grove', phase:2, yoy:5.2},
  {route:'53', name:'Pulaski', phase:3, yoy:14.9},
  {route:'77', name:'Belmont', phase:3, yoy:2.8},
  {route:'55', name:'Garfield', phase:3, yoy:-1.0},
  {route:'82', name:'Kimball/Homan', phase:3, yoy:-1.7},
];

const DID_DATA = [
  {phase:1, label:'Phase 1', estimate:428, pct:5.9, ci_lo:42, ci_hi:799},
  {phase:2, label:'Phase 2', estimate:514, pct:4.2, ci_lo:163, ci_hi:832},
  {phase:3, label:'Phase 3', estimate:1142, pct:10.4, ci_lo:213, ci_hi:2492},
];

// Monthly FN share of total CTA bus ridership (from notebook 05)
const SHARE_DATA = {
  months: ['2024-01','2024-02','2024-03','2024-04','2024-05','2024-06','2024-07','2024-08','2024-09','2024-10','2024-11','2024-12','2025-01','2025-02','2025-03','2025-04','2025-05','2025-06','2025-07','2025-08','2025-09','2025-10','2025-11'],
  share: [36.8,36.9,37.1,37.2,37.0,36.8,36.9,37.1,37.0,36.9,37.0,36.8,37.0,37.1,37.4,37.6,37.8,37.9,38.0,38.1,38.3,38.5,38.7],
};

const ROUTE_YOY_MAP = {};
YOY_DATA.forEach(d => { ROUTE_YOY_MAP[d.route] = d; });

// ── PLOTLY DEFAULTS ──
const PLOT_FONT = {family:'IBM Plex Sans, sans-serif', color:'#1A1A18'};
const PLOT_LAYOUT_BASE = {
  font: PLOT_FONT,
  paper_bgcolor:'#fff',
  plot_bgcolor:'#fff',
  margin: {l:160, r:32, t:24, b:48},
  hoverlabel: {font: {family:'IBM Plex Mono, monospace', size:13}},
};
const PLOT_CONFIG = {displayModeBar:false, responsive:true};

// ── MAP ──
const map = L.map('map', {scrollWheelZoom:false}).setView([41.8781, -87.6298], 11);
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
  attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> &copy; <a href="https://carto.com/">CARTO</a>',
  maxZoom:18
}).addTo(map);

fetch('routes.geojson')
  .then(r => r.json())
  .then(geojson => {
    L.geoJSON(geojson, {
      style: feature => ({
        color: PHASE_COLORS[feature.properties.phase],
        weight: 3.5,
        opacity: 0.8,
      }),
      onEachFeature: (feature, layer) => {
        const p = feature.properties;
        const yoy = ROUTE_YOY_MAP[p.route_id];
        const yoyStr = yoy
          ? `<div class="popup-stat">${yoy.yoy > 0 ? '+' : ''}${yoy.yoy}% <span class="${yoy.yoy >= 0 ? 'positive' : 'negative'}">YoY</span></div>`
          : '<div class="popup-stat" style="color:#9C9C96">No post-launch data yet</div>';
        layer.bindPopup(`
          <div class="popup-route">#${p.route_id} ${p.route_name}</div>
          <div class="popup-phase">${p.phase_label}</div>
          ${yoyStr}
        `, {maxWidth:240});
        layer.on('mouseover', function() { this.setStyle({weight:6, opacity:1}); });
        layer.on('mouseout', function() { this.setStyle({weight:3.5, opacity:0.8}); });
      }
    }).addTo(map);
  });

// ── CHART: DiD by Phase (dot plot with CI lines) ──
Plotly.newPlot('chart-did', [{
  type:'scatter',
  mode:'markers',
  y: DID_DATA.map(d => d.label),
  x: DID_DATA.map(d => d.estimate),
  error_x: {
    type:'data',
    symmetric:false,
    array: DID_DATA.map(d => d.ci_hi - d.estimate),
    arrayminus: DID_DATA.map(d => d.estimate - d.ci_lo),
    color:'#5C5C58',
    thickness:2,
    width:8,
  },
  marker: {color: DID_DATA.map(d => PHASE_COLORS[d.phase]), size:14},
  hovertemplate: '<b>%{y}</b><br>+%{x} rides/day<extra></extra>',
}], {
  ...PLOT_LAYOUT_BASE,
  height:260,
  margin:{l:90, r:40, t:40, b:48},
  xaxis:{title:'Additional rides per day', gridcolor:'#E8E8E4', zeroline:true, zerolinecolor:'#D4D4CE', range:[-200, 2700]},
  yaxis:{autorange:'reversed'},
  annotations: DID_DATA.map(d => ({
    x: d.estimate,
    y: d.label,
    text: `<b>+${d.estimate}</b> rides/day (+${d.pct}%)`,
    showarrow:false,
    font:{family:'IBM Plex Mono, monospace', size:13, color:'#1A1A18'},
    yshift: 22,
  })),
}, PLOT_CONFIG);

// ── CHART: YoY by Route ──
// Sort by YoY value; always use phase color (even for negative bars)
const yoySorted = [...YOY_DATA].sort((a,b) => a.yoy - b.yoy);
Plotly.newPlot('chart-yoy', [{
  type:'bar',
  orientation:'h',
  y: yoySorted.map(d => `#${d.route} ${d.name}`),
  x: yoySorted.map(d => d.yoy),
  marker: {color: yoySorted.map(d => PHASE_COLORS[d.phase])},
  text: yoySorted.map(d => `${d.yoy > 0 ? '+' : ''}${d.yoy}%`),
  textposition:'outside',
  textfont: {family:'IBM Plex Mono, monospace', size:12, color:'#1A1A18'},
  hovertemplate: '<b>%{y}</b><br>%{x}% YoY change<extra></extra>',
}], {
  ...PLOT_LAYOUT_BASE,
  height: 520,
  margin:{l:190, r:70, t:16, b:48},
  xaxis:{title:'Year-over-year ridership change (%)', gridcolor:'#E8E8E4', zeroline:true, zerolinecolor:'#1A1A18', zerolinewidth:1},
  yaxis:{},
}, PLOT_CONFIG);

// ── CHART: Ridership Share ──
Plotly.newPlot('chart-share', [{
  type:'scatter',
  mode:'lines',
  x: SHARE_DATA.months,
  y: SHARE_DATA.share,
  line: {color:'#0066CC', width:2.5},
  fill:'tozeroy',
  fillcolor:'rgba(0,102,204,0.06)',
  hovertemplate: '%{x}<br>FN share: %{y:.1f}%<extra></extra>',
}], {
  ...PLOT_LAYOUT_BASE,
  height:340,
  margin:{l:60, r:32, t:16, b:48},
  xaxis:{title:'', gridcolor:'#E8E8E4'},
  yaxis:{title:'FN share of total ridership (%)', range:[35, 40], gridcolor:'#E8E8E4'},
  shapes: [
    {type:'line', x0:'2025-03', x1:'2025-03', y0:0, y1:1, yref:'paper', line:{color:PHASE_COLORS[1], width:1.5, dash:'dot'}},
    {type:'line', x0:'2025-06', x1:'2025-06', y0:0, y1:1, yref:'paper', line:{color:PHASE_COLORS[2], width:1.5, dash:'dot'}},
    {type:'line', x0:'2025-08', x1:'2025-08', y0:0, y1:1, yref:'paper', line:{color:PHASE_COLORS[3], width:1.5, dash:'dot'}},
  ],
  annotations: [
    {x:'2025-03', y:39.8, yref:'y', text:'Phase 1', showarrow:false, font:{size:11, color:PHASE_COLORS[1], weight:600}, xanchor:'right', xshift:-6},
    {x:'2025-06', y:39.8, yref:'y', text:'Phase 2', showarrow:false, font:{size:11, color:PHASE_COLORS[2], weight:600}, xanchor:'right', xshift:-6},
    {x:'2025-08', y:39.8, yref:'y', text:'Phase 3', showarrow:false, font:{size:11, color:PHASE_COLORS[3], weight:600}, xanchor:'right', xshift:-6},
  ],
}, PLOT_CONFIG);
</script>

</body>
</html>
